# =================================================================
# BEAGLEBONE BLACK ROBOTICS MACHINE CONFIGURATION
# =================================================================
# This machine configuration defines a BeagleBone Black optimized for
# robotics applications with real-time capabilities and hardware interfaces.
#
# Hardware specifications:
# - TI AM335x ARM Cortex-A8 1GHz processor
# - 512MB DDR3 RAM
# - 4GB eMMC flash storage
# - 92 expansion pins (GPIO, I2C, SPI, UART, PWM, ADC)
# - Real-time PRU (Programmable Real-time Unit) subsystem
# - 10/100 Ethernet, USB host/device, HDMI, microSD
#
# Robotics features enabled:
# - Real-time kernel (PREEMPT_RT)
# - GPIO control for sensors and actuators
# - I2C for sensor communication
# - SPI for high-speed devices
# - UART for GPS and communication modules
# - PWM for motor and servo control
# - ADC for analog sensor reading
# - PRU for ultra-low latency operations
# =================================================================

#@TYPE: Machine
#@NAME: BeagleBone Robotics Platform
#@DESCRIPTION: Machine configuration for BeagleBone-based robotics controller with real-time capabilities

# =================================================================
# BASE MACHINE CONFIGURATION
# =================================================================
# Inherit from the standard BeagleBone Yocto configuration
# This provides the basic hardware support and bootloader configuration
require conf/machine/beaglebone-yocto.conf

# =================================================================
# ROBOTICS-SPECIFIC FEATURES
# =================================================================
# Add robotics-specific machine features to enable hardware interfaces
# - robotics: Custom feature for robotics applications
# - gpio: General Purpose Input/Output support
# - i2c: Inter-Integrated Circuit bus for sensors
# - spi: Serial Peripheral Interface for high-speed devices
# - uart: Universal Asynchronous Receiver-Transmitter for communication
MACHINE_FEATURES += "robotics gpio i2c spi uart"

# =================================================================
# HARDWARE FEATURE EXCLUSIONS
# =================================================================
# Remove RTC (Real-Time Clock) from backfill to avoid conflicts
# The BeagleBone doesn't have a built-in battery-backed RTC
# External RTC modules can be added via I2C if needed
MACHINE_FEATURES_BACKFILL_CONSIDERED += "rtc"

# =================================================================
# ESSENTIAL ROBOTICS PACKAGES
# =================================================================
# Automatically install the robotics controller application
# This ensures the main robotics software is always present
# MACHINE_ESSENTIAL_EXTRA_RDEPENDS packages are installed in all images
MACHINE_ESSENTIAL_EXTRA_RDEPENDS += "robotics-controller"

# =================================================================
# KERNEL CONFIGURATION
# =================================================================
# Use the Yocto kernel with real-time patches (linux-yocto-rt)
# This provides PREEMPT_RT support for deterministic timing
PREFERRED_PROVIDER_virtual/kernel = "linux-yocto-rt"

# =================================================================
# DEVICE TREE CONFIGURATION
# =================================================================
# Specify the device tree blob for BeagleBone Black robotics configuration
# This device tree enables all robotics hardware interfaces:
# - GPIO for LEDs, buttons, and digital sensors
# - I2C1 for sensor communication (dedicated pins)
# - SPI0 for high-precision sensors and ADCs
# - PWM for motor control (EHRPWM1A/1B)
# - UART1 for GPS modules
# - ADC for analog sensors (8 channels)
KERNEL_DEVICETREE = "am335x-boneblack-robotics.dtb"

# =================================================================
# BOOTLOADER CONFIGURATION
# =================================================================
# U-Boot machine configuration for AM335x evaluation module
# This provides the correct bootloader setup for BeagleBone Black
UBOOT_MACHINE = "am335x_evm_config"
